<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <title> - </title>
    
  </head>
  <body data-type="book">
    

    <section data-type="chapter" id="docbookref">
<h1>Writing in DocBook</h1>

<p>Atlas supports writing in <a data-original-title="" href="http://docbook.org/" title="">DocBook</a> (versions 4.4, 4.5, and 5.0) in addition to HTMLBook. Files ending in <code>.xml</code> will be converted to HTMLBook when building. DocBook is an OASIS standard for XML that is great for writing long, technical documents that have complex structure and cross-references. This guide is tailored to help authors get the most out of Atlas’ DocBook authoring toolchain; for more information, see ???. DocBook files in Atlas can be edited using the Code Editor.</p>

<section data-type="sect1" id="docbook-xml-markup-guidelines-yOpf9">
<h1>DocBook XML Markup Guidelines</h1>

<p>Here are some guidelines that you may find helpful for writing in DocBook. If you have questions about what markup to use for a particular element, or whether our toolchain supports a specific type of markup, please contact <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a>.</p>
</section>

<section data-type="sect1" id="keep_it_simple">
<h1>Keep It Simple</h1>

<p>“Keep it Simple” sounds a bit silly when referring to something as complex as DocBook, but the point is that even though DocBook offers over 400 elements, you’ll need only a fraction of them. DocBook is meant to be comprehensive across a universe of technical documentation, but we’re dealing with a very specific subset: content in an O’Reilly title. Practically speaking, you’ll use elements similar to standard HTML elements, such as <code>itemizedlist</code> and <code>table</code>. You can safely stay away from more exotic elements such as <code>confsponsor</code>, <code>msgsub</code>, and <code>seriesvolnums</code>.</p>

<p><a data-type="xref" href="#common_elements">???</a> covers some of the commonly used elements in O’Reilly books.</p>

<aside data-type="sidebar" id="can-i-change-the-appearance-of-elements-in-my-book-XJkFV">
<h5>Can I Change the Appearance of Elements in My Book?</h5>

<p>We have developed our series stylesheets according to O’Reilly house style and the design standards for each series. If something isn’t showing up as you’d expect in your PDF, or if you want to know whether it’s possible to make a customization (after consulting with your editor on house style), please contact <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a>.</p>
</aside>

<section data-type="sect2" id="using-elements-correctly-wRmib">
<h2>Using Elements Correctly</h2>

<p>For XML<!--?dbhtml orphans="3"?--> to be valid, it must not only be well-formed (i.e., all the start and end tags match), it must also have all the tags in the proper hierarchy according to the associated DTD (in our case, the DocBook 4.5 DTD). The tag at the top of the hierarchy is called the root element (e.g., <code>&lt;book&gt;</code>) and contains various child elements (e.g., <code>&lt;chapter&gt;</code>s or <code>&lt;part&gt;</code>s). Logical rules apply, such as the fact that a <code>&lt;sect3&gt;</code> cannot be directly nested within a <code>&lt;sect1&gt;</code>; it must be within a <code>&lt;sect2&gt;</code>. Improper nesting will result in invalid DocBook.</p>

<div data-type="note" id="id-X5MFK"><h6>Note</h6>
<p>One very good reason to use an XML editor is that it will safeguard you from moving, adding, or deleting elements in ways that don’t follow the DTD hierarchy.</p>
</div>

<p>The terms <em>tag</em> and <em>element</em> are sometimes used interchangeably, but there is a distinction. For example, <code>&lt;chapter&gt;</code> is a tag that indicates the start of a <code>chapter</code> element. For the XML document to be well-formed, it must contain an end tag, <code>&lt;/chapter&gt;</code>. Some tags are self-contained and stand alone as complete elements, without the need for separate end tags. For example, <code>&lt;xref linkend="foo"/&gt;</code> is self-contained. If you’re familiar with HTML, the rules are pretty much the same.</p>
</section>

<section data-type="sect2" id="sample-markup-and-pdfs-Xz1C6">
<h2>Sample Markup and PDFs</h2>

<p>This document is made up of the same DocBook markup as our books, so you can use it as a model for your own manuscript. In addition to the section <a data-type="xref" href="#common_elements">???</a>, please check out some samples we have posted at the URL below. Generally it’s best to look at the PDF version for additional commentary before delving into the XML.</p>

<ul class="simplelist">
	<li><a href="https://github.com/oreillymedia/docbook_samples">https://github.com/oreillymedia/docbook_samples</a></li>
</ul>

<p>The samples directory contains the following skeleton files, if you need them:</p>

<ul>
	<li>
	<p><code data-type="filename">afterword.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">appa.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">book.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">ch00.xml</code> (Preface—includes standard boilerplate language)</p>
	</li>
	<li>
	<p><code data-type="filename">ch01.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">dedication.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">foreword.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">part1.xml</code></p>
	</li>
	<li>
	<p><code data-type="filename">glossary.xml</code></p>
	</li>
</ul>

<p>Please contact <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a> if you have any questions about using these files.</p>

<aside data-type="sidebar" id="the-elements-in-my-pdfs-dont-look-like-the-ones-in-this-document-2Dds3">
<h5>The Elements in My PDFs Don’t Look Like the Ones in this Document</h5>

<p>The rendered version of this document is an example of O’Reilly’s Animal Guide series stylesheet. You may be working in a different series, such as Hacks or Cookbook. That’s fine. You’ll use the same XML markup; it’s the underlying series stylesheet (i.e., <code>&lt;book role="animal"&gt;</code>) that determines how the elements appear in the PDF.</p>
</aside>
</section>
</section>

<section data-type="sect1" id="organizing_files">
<h1>Organizing Your Files</h1>

<p>As you will see in the <code data-type="filename">book.xml</code> file that O’Reilly provides for you, it contains only references to the chapter files and some metadata. Each chapter file is a complete DocBook document with its own <a href="http://www.docbook.org/tdg/en/html/ch02.html#d0e2566"><code>DOCTYPE</code></a> declaration, which makes validation easier. Once you <a href="http://chimera.labs.oreilly.com/books/1230000000065/ch05.html">check out your repository</a>, you can open the <code data-type="filename">ch01.xml</code> file and begin writing.</p>

<div data-type="note" id="id-L9vTo"><h6>Note</h6>
<p>This section discusses the files as we structure and name them once they are submitted to Production, but when you are working on them, you can structure and name them in any way that’s convenient for you. All that really matters is that you have a valid <code data-type="filename">book.xml</code>—whether it’s a monolithic file you edit directly, generate from a custom Makefile, etc.</p>
</div>

<section data-type="sect2" id="adding_chapters_to_the_book">
<h2>Chapters</h2>

<p>The <code data-type="filename">book.xml</code> indicates which files comprise the book and the order in which they appear. Here’s an example:</p>

<pre data-type="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" 
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"&gt;
&lt;book role="animal"&gt;
&lt;title&gt;Some Fantastic Book&lt;/title&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="dedication.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="bookinfo.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch00.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch01.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch02.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch03.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch04.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch05.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appa.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appb.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appc.xml"/&gt;
&lt;/book&gt;</pre>

<p>You can name your chapter files whatever you’d like,<span data-type="footnote">O’Reilly’s filenaming convention is <code data-type="filename">ch00</code>, <code data-type="filename">ch01</code>, etc. When your chapters come into Production, we will rename them per this convention so that they flow through our Production workflows easily.</span> and then reference and include them in the <code data-type="filename">book.xml</code> as shown above.</p>

<section data-type="sect3" id="chapter-contributors-8Pdc4">
<h3>Chapter contributors</h3>

<p>For books with multiple contributors, you may want an author name to appear with each chapter. Simply add the following markup above each chapter title:</p>

<pre data-type="programlisting">
&lt;chapterinfo&gt;
  &lt;author&gt;
    &lt;firstname&gt;Author&lt;/firstname&gt;

    &lt;surname&gt;Name&lt;/surname&gt;
  &lt;/author&gt;
&lt;/chapterinfo&gt;</pre>

<p>You can also use this markup for forewords and prefaces (just use <code>prefaceinfo</code> instead of <code>chapterinfo</code>) as well as appendixes (use <code>appendixinfo</code>). Please note that contributor names in a foreword or preface will render <em>after</em> the rest of the content, right-aligned, and preceded by an em dash.</p>
</section>
</section>

<section data-type="sect2" id="parts-5raHg">
<h2>Parts</h2>

<p>If you want to group your chapters into parts, grab a skeleton part file here:</p>

<ul class="simplelist">
	<li><a href="https://github.com/oreillymedia/docbook_samples/blob/master/part1.xml">https://github.com/oreillymedia/docbook_samples/blob/master/part1.xml</a></li>
</ul>

<p>Then add your chapter files to the appropriate <code data-type="filename">part<em><code>N</code></em>.xml</code> file instead of the <code data-type="filename">book.xml</code> file.</p>
</section>

<section data-type="sect2" id="using_sect1s_etc">
<h2>Sections</h2>

<p>Each chapter is made up of sections. Please use <code>sect1</code>, <code>sect2</code>, and <code>sect3</code> elements—<em>not</em> generic <code>section</code> elements—to structure your chapter. By default only <code>sect1</code> and <code>sect2</code> titles will appear in the TOC.</p>

<p>The barebones structure of a chapter is something like this:</p>

<pre data-type="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" 
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"&gt;
&lt;chapter id="chapter_id"&gt;
  &lt;title&gt;Chapter Title Here&lt;/title&gt;
  &lt;sect1&gt;
    &lt;title&gt;Sect1 Title Here&lt;/title&gt;
    &lt;para&gt;Text goes here...&lt;/para&gt;
    &lt;sect2&gt;
      &lt;title&gt;Sect2 Title Here&lt;/title&gt;
      &lt;para&gt;Text goes here...&lt;/para&gt;
      &lt;sect3&gt;
        &lt;title&gt;Sect3 title here&lt;/title&gt;
        &lt;para&gt;Text goes here...&lt;/para&gt;
      &lt;/sect3&gt;
    &lt;/sect2&gt;
  &lt;/sect1&gt;
&lt;/chapter&gt;</pre>

<p>Note the <code>para</code>s between sections. We ask that you don’t add a section directly after the previous section’s title with no <code>para</code> or other element in between (though doing so is valid). For example, don’t do this:</p>

<pre data-type="programlisting">
&lt;sect1&gt;
  &lt;title&gt;Sect1 Title Here&lt;/title&gt;
  &lt;sect2&gt;
    &lt;title&gt;Sect2 Title Here&lt;/title&gt;
    &lt;para&gt;Text goes here...&lt;/para&gt;
  &lt;/sect2&gt;
&lt;/sect1&gt;</pre>

<div data-type="note" id="id-Rgetz"><h6>Note</h6>
<p>For a complete list of O’Reilly’s style conventions, including proper heading and title capitalization, consult the <a href="http://oreilly.com/oreilly/author/stylesheet.html">O’Reilly Stylesheet and Word List</a>. Also keep in mind that, other than inside code listings, you should not put blank lines or paras in your XML documents.</p>
</div>

<p>You may also use <code>sect4</code> elements, although they are not very common in O’Reilly books. A <code>sect4</code> title renders inline, with an autogenerated period following it, rather than as a separate heading.</p>
</section>
</section>

<section data-type="sect1" id="common_elements">
<h1>Common Elements</h1>

<p>The following sections describe common DocBook elements in O’Reilly books.</p>

<section data-type="sect2" id="block-versus-inline-gk0S0">
<h2>Block Versus Inline</h2>

<p>There are two kinds of elements:</p>

<dl>
	<dt>Block</dt>
	<dd>
	<p>Usually presented with a paragraph break before and after them, block elements may contain character data, inline elements, and possibly other block elements. Examples include paras, lists, sidebars, tables, and block quotes.</p>
	</dd>
	<dt>Inline</dt>
	<dd>
	<p>Usually distinguished by a font change rather than obvious breaks, inline elements may contain character data and possibly other inline elements, but never block elements. Examples include cross-references, filenames, commands, and URLs.</p>
	</dd>
</dl>

<aside data-type="sidebar" id="avoid-putting-block-elements-in-paras-k51SE">
<h5>Avoid Putting Block Elements in paras</h5>

<p>To prevent spacing problems in rendered versions, please do not nest block elements within <code>para</code>s. In other words, block elements should come <em>after</em> the closing <code>&lt;/para&gt;</code> tag, not be nested within <code>&lt;para&gt;</code> tags. Some of the block elements that should never be nested in <code>para</code>s are the <span class="keep-together">following</span>:</p>

<ul class="simplelist">
	<li><code>blockquote</code></li>
	<li><code>calloutlist</code></li>
	<li><code>example</code></li>
	<li><code>figure</code></li>
	<li><code>informalfigure</code></li>
	<li><code>informaltable</code></li>
	<li><code>itemizedlist</code></li>
	<li><code>literallayout</code></li>
	<li><code>note</code></li>
	<li><code>orderedlist</code></li>
	<li><code>programlisting</code></li>
	<li><code>sidebar</code></li>
	<li><code>simplelist</code></li>
	<li><code>table</code></li>
	<li><code>variablelist</code></li>
	<li><code>warning</code></li>
</ul>
</aside>
</section>

<section data-type="sect2" id="inline-font-markup-KGZFe">
<h2>Inline Font Markup</h2>

<p>Here are some commonly used inline elements:</p>

<dl>
	<dt><em>&lt;citation&gt;</em></dt>
	<dd>
	<p>Used in cross-reference syntax. Authors can also use this for hardcoded <span class="keep-together">cross-</span><span class="keep-together">references</span> to other, non-O’Reilly books. As in, “See <em>TITLE</em>, published by <em><code>publisher</code></em>”.</p>
	</dd>
	<dt><span data-type="command"><em>&lt;command&gt;</em></span></dt>
	<dd>
	<p>An executable program, or the entry a user makes to execute a command. As in, “Compare the two documents with the <span data-type="command"><em>diff</em></span> command.”</p>
	</dd>
	<dt><em>&lt;email&gt;</em></dt>
	<dd>
	<p>An email address, such as <a class="email" href="mailto:example@oreilly.com"><em>example@oreilly.com</em></a>. (Note that these will become hyperlinks in online versions, so for fake or example addresses, use <code>&lt;emphasis&gt;</code> <span class="keep-together">instead</span>.)</p>
	</dd>
	<dt><em>&lt;emphasis&gt;</em></dt>
	<dd>
	<p>Provided for use where you would traditionally use <em>italics</em> to emphasize a word or phrase.</p>
	</dd>
	<dt><strong>&lt;emphasis role="bold"&gt;</strong></dt>
	<dd>
	<p>A general-purpose tag provided for where you would use <strong>bold</strong> type to emphasize a word or phrase. (Note that <a class="orm:hideurl" href="http://oreilly.com/oreilly/author/stylesheet.html">O’Reilly house style</a> prefers italics for emphasis.)</p>
	</dd>
	<dt><span class="roman">&lt;phrase role="roman"&gt;</span></dt>
	<dd>
	<p>Provided for use within italicized text where you would ordinarily use <span class="roman">italics</span> to emphasize a word or phrase.</p>
	</dd>
	<dt><code data-type="filename">&lt;filename&gt;</code></dt>
	<dd>
	<p>Used for the name of a file, directory, or path (e.g., <code data-type="filename">/usr/bin</code>).</p>
	</dd>
	<dt><span data-type="keycap">&lt;keycap&gt;</span></dt>
	<dd>
	<p>The text printed on a physical key on a computer keyboard (e.g., <span data-type="keycap">Return</span>).</p>
	</dd>
	<dt><code>&lt;literal&gt;</code></dt>
	<dd>
	<p>Any stretch of text that must appear in <code>constant width</code> font.</p>
	</dd>
	<dt><em><code>&lt;replaceable&gt;</code></em></dt>
	<dd>
	<p>Text that should be replaced with user-supplied values or by values determined by context. Appears in <em><code>constant width italic</code></em>.</p>
	</dd>
	<dt><sub>&lt;subscript&gt;</sub></dt>
	<dd>
	<p>A subscript character.</p>
	</dd>
	<dt><sup>&lt;superscript&gt;</sup></dt>
	<dd>
	<p>A superscript character.</p>
	</dd>
	<dt><em>&lt;ulink url="ulink.org"/&gt;</em></dt>
	<dd>
	<p>Several styles of <code>ulink</code>s and various URL markup/rendering options are supported. See <a data-type="xref" href="#inserting_hyperlinks">???</a> for more details. (Note that these will become hyperlinks in online versions, so for fake or example URLs, use <code>&lt;emphasis&gt;</code> or <code>&lt;uri&gt;</code> instead.)</p>
	</dd>
	<dt><strong><code>&lt;userinput&gt;</code></strong></dt>
	<dd>
	<p><strong><code>Data entered by the user</code></strong>, typically at a prompt line. Use with <em><code>&lt;replaceable&gt;</code></em> if needed: <strong><code>&lt;userinput&gt;&lt;<em><code>replaceable</code></em>&gt;&lt;userinput&gt;</code></strong></p>
	</dd>
</dl>
</section>

<section data-type="sect2" id="creating_xrefs">
<h2>Cross-References</h2>

<p>All cross-references to titled elements—figures, tables, <span class="keep-together">examples</span>, sections, chapters, parts, etc.—should be marked up using <code>xref</code>s, not written in plain text. <code>xref</code> elements will become live hyperlinks in online versions, and they will automatically update if you move the referenced elements around while editing. There is never any need to hardcode labels (e.g., “Chapter 1”, “Figure 1”) or page numbers, as these aspects of the rendered <code>xref</code> are autogenerated by the stylesheets.</p>

<p>To insert an <code>xref</code>, follow these steps:</p>

<ol>
	<li>
	<p>Note the <code>id</code> of the element you are referencing. If the element does not have an <code>id</code>, you will need to add one. For the book to be valid, <code>id</code> attributes must be unique across the entire book, have no spaces, not contain a colon, and not start with a number. Here’s an example of a figure <code>id</code>:</p>

	<pre data-type="programlisting">
&lt;figure id="figure_titles_written_with_underscores_make_nice_ids"&gt;</pre>
	</li>
	<li>
	<p>Once you have the <code>id</code>, you can insert an <code>xref</code> element that references it via a <code>linkend</code> attribute, like so:</p>

	<pre data-type="programlisting">
&lt;xref linkend="figure_titles_written_with_underscores_make_nice_ids" /&gt;</pre>
	</li>
</ol>

<div data-type="warning" id="id-KvnHr"><h6>Warning</h6>
<p>You cannot use the word “inherit” as an <code>id</code>. It won’t render properly.</p>
</div>

<p>The following table shows examples of <code>xref</code> markup and rendering for various <span class="keep-together">elements</span>.</p>

<table>
	<thead>
		<tr>
			<th><span class="keep-together">Element to be referenced</span></th>
			<th>xref markup</th>
			<th><span class="keep-together">xref rendering</span></th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><code>&lt;sect1 id="keep_it_simple"&gt;</code></td>
			<td><code>&lt;xref linkend="keep_it_simple"/&gt;</code></td>
			<td><a data-type="xref" href="#keep_it_simple">???</a></td>
		</tr>
		<tr>
			<td><code>&lt;chapter id="picking_an_xml_editor"&gt;</code></td>
			<td><code>&lt;xref linkend="picking_an_xml_editor"/&gt;</code></td>
			<td><a data-type="xref" href="#picking_an_xml_editor">???</a></td>
		</tr>
		<tr>
			<td><code>&lt;figure id="docbook_duck_fig"&gt;</code></td>
			<td><code>&lt;xref linkend="docbook_duck_fig"/&gt;</code></td>
			<td><a data-type="xref" href="#docbook_duck_fig">???</a></td>
		</tr>
		<tr>
			<td><code>&lt;example id="sample_example"&gt;</code></td>
			<td><code>&lt;xref linkend="sample_example"/&gt;</code></td>
			<td><a data-type="xref" href="#sample_example">???</a></td>
		</tr>
		<tr>
			<td><code>&lt;table id="maximum_widths"&gt;</code></td>
			<td><code>&lt;xref linkend="maximum_widths"/&gt;</code></td>
			<td><a data-type="xref" href="#maximum_widths">???</a></td>
		</tr>
	</tbody>
</table>

<p>Note that cross-references to terms in a Glossary use special markup, not <code>xref</code>. See the <a class="orm:hideurl:ital" href="https://github.com/oreillymedia/docbook_samples/tree/master/glossary">glossary directory on GitHub</a> for details.</p>
</section>

<section data-type="sect2" id="figures">
<h2>Figures</h2>

<p>Figures have a title (aka caption), an autogenerated number, and (per O’Reilly house style) an explicit cross-reference. You do not need to number the figure in the XML; the O’Reilly stylesheets autogenerate the number in the figure label and in all <code>xref</code>s to it. Unless you have a special reason for using an informal figure (e.g., if it’s impractical for the image to have a title), you should use a formal figure. See <a data-type="xref" href="#accessibility">???</a> for an example of informal figure markup. It’s essentially the same as a <code>figure</code>, but without the <code>id</code> attribute or <code>title</code> element.</p>

<p>For more information on how to prepare the image files themselves, see the <a href="http://oreillynet.com/oreilly/authors/welcome/illustrations.csp">O’Reilly Media Illustration Guidelines</a>.</p>

<p>Here’s an example of proper <code>figure</code> markup:</p>

<pre data-type="programlisting">
&lt;figure id="docbook_duck_fig"&gt;
&lt;title&gt;The DocBook duck&lt;/title&gt;
&lt;mediaobject&gt;
  &lt;imageobject&gt;
    &lt;imagedata fileref="images/docbook_duck.png" format="PNG" 
               width="4.8in"/&gt;
  &lt;/imageobject&gt;
&lt;/mediaobject&gt;
&lt;/figure&gt;</pre>

<div data-type="note" id="id-nk7iR"><h6>Note</h6>
<p>If you are working on files from an earlier edition of a book, you may see the more complex figure markup we formerly used in Production (it includes a second <code>imageobject</code>, among other things). For any new figures you add, you can stick with the simpler markup shown here.</p>
</div>

<p><a data-type="xref" href="#docbook_duck_fig">???</a> shows how the above markup renders.</p>

<figure id="docbook_duck_fig" style="float: 0"><img src="images/docbook_duck.png" width="4.8in">
<figcaption>The DocBook duck</figcaption>
</figure>

<p>The <code>width</code> attribute value in the <code>imagedata</code> is a quick way to make large images “fit” within the PDF page while you’re writing your manuscript. (Note that this is strictly optional, and for your own convenience; <code>width</code> attributes will be stripped out during Production.) See <a data-type="xref" data-xrefstyle="select:nopage" href="#image_sizing">???</a> below and <a data-type="xref" href="#inline_graphics">???</a> for more about image sizing.</p>

<p>Make sure to add your image files to the repo (typically in a <code data-type="filename">figs/</code> or <code data-type="filename">images/</code> directory). Then set the <code>fileref</code> and <code>format</code> attributes in the XML markup so that they match the image file names and types exactly. For example, if an image is named <code data-type="filename">battery.png</code> in the <code data-type="filename">figs/</code> directory, it should be referenced in the XML as <code data-type="filename">figs/battery.png</code>, not <code data-type="filename">figs/Battery.png</code>, and the <code>format</code> should be <code>PNG</code>.</p>

<section data-type="sect3" id="figure-floating-DLrfb">
<h3>Figure floating</h3>

<p>Figures appear exactly where you place them in the text, which can sometimes create PDF pages with a lot of white space. While it is not generally necessary, you can add an attribute of <code>float="true"</code> so that the text flows around the image. For example:</p>

<pre data-type="programlisting">
&lt;figure id="docbook_duck_fig" float="true"&gt;
&lt;title&gt;The DocBook duck&lt;/title&gt;
&lt;mediaobject&gt;
  &lt;imageobject&gt;
    &lt;imagedata fileref="images/docbook_duck.png" format="PNG" 
               width="4.8in"/&gt;
  &lt;/imageobject&gt;
&lt;/mediaobject&gt;
&lt;/figure&gt;</pre>
</section>

<section data-type="sect3" id="image_sizing">
<h3>Image sizing</h3>

<p>When your book goes into Production, O’Reilly Illustration staff will handle processing the images you submit, including scaling them to the appropriate size. However, for the purposes of generating draft PDF documents, you can scale your images using the <code>width</code> attribute of the <code>imagedata</code> element, which scales the image proportionally to the width value supplied. For example, to set a width of 4.8 inches (the maximum width for Animal Guide books), you’d add a <code>width</code> attribute value of <code>4.8in</code>.</p>

<p><a data-type="xref" href="#maximum_widths">???</a> contains a list of maximum widths you can use to scale images to fit your book’s design.</p>

<table id="maximum_widths">
	<caption>Maximum widths for figures in different book templates</caption>
	<thead>
		<tr>
			<th>Book series</th>
			<th>Maximum width value (in inches)</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Animal or Cookbook</td>
			<td><code>4.8in</code></td>
		</tr>
		<tr>
			<td>Small Animal (and other books with a 6×9 inch trim size)</td>
			<td><code>4.3in</code></td>
		</tr>
		<tr>
			<td>Hacks</td>
			<td><code>4.7in</code></td>
		</tr>
	</tbody>
</table>

<p>For more complete under-the-hood info, see <a href="http://www.sagehill.net/docbookxsl/ImageSizing.html">http://www.sagehill.net/docbookxsl/ImageSizing.html</a>. (Note that not everything described there will work for O’Reilly’s <span class="keep-together">toolchain</span>.)</p>
</section>

<section data-type="sect3" id="inline_graphics">
<h3>Inline graphics</h3>

<p>If you need to add an inline graphic (e.g., a small icon that is part of the text), use an <code>inlinemediaobject</code>:</p>

<pre data-type="programlisting">
&lt;inlinemediaobject&gt;
   &lt;imageobject&gt;
      &lt;imagedata fileref="images/icons_0501.png" width="0.12in"/&gt;
   &lt;/imageobject&gt;
&lt;/inlinemediaobject&gt;</pre>

<p>A <code>width</code> is required for an <code>inlinemediaobject</code> so that the processor knows how much space to allocate for it. The value <code>0.12in</code> works well. You can also find the width of the graphic using a web browser, Adobe Acrobat, or any other program that shows you an image’s dimensions.</p>
</section>

<section data-type="sect3" id="ascii-art-0q1FG">
<h3>ASCII art</h3>

<p>ASCII art may be usable, but it does create ambiguities for Tools staff who perform an “intake” on your files when they come into Production, as well as the illustrators. Please see detailed guidelines and examples at <a href="https://github.com/oreillymedia/docbook_samples/tree/master/ascii_art">https://github.com/oreillymedia/docbook_samples/tree/master/ascii_art</a>.</p>
</section>

<section data-type="sect3" id="accessibility">
<h3>Alt text for images</h3>

<p>O’Reilly is committed to making electronic formats of its books accessible to visually impaired readers. EPUB versions of our titles contain alternative text descriptions for images (in the <code>alt</code> attribute of <code>img</code> elements) whenever possible.</p>

<p>By default, for <code>figure</code> elements, we use the contents of the <code>title</code> element as the <code>alt</code> text. However, you can supply your own custom alt text for a <code>figure</code> by adding a <code>textobject</code> element as a child of the figure’s <code>mediaobject</code>, and enclosing the <code>alt</code> text in a <code>phrase</code> element. Here’s an example of the markup to use:</p>

<pre data-type="programlisting">
&lt;figure id="figure_with_custom_alt_text"&gt;
  &lt;title&gt;Figure image with custom alt text&lt;/title&gt;

  &lt;mediaobject&gt;
    &lt;imageobject&gt;
      &lt;imagedata fileref="images/universal_design_for_web_applications_cover.png"/&gt;
    &lt;/imageobject&gt;

    &lt;textobject&gt;
      &lt;phrase&gt;Universal Design for Web Applications Cover&lt;/phrase&gt;
    &lt;/textobject&gt;
  &lt;/mediaobject&gt;
&lt;/figure&gt;</pre>

<p>For images you include in your book that do not have <code>title</code> elements (e.g., <code>informalfigure</code>s and <code>inlinemediaobject</code>s), we highly encourage you to supply your own custom <code>alt</code> text in <code>textobject</code>s. (By default, we use the text “image with no caption” as the <code>alt</code> text for <code>informalfigure</code>s and leave <code>alt</code> attributes empty for <code>inlinemediaobject</code>s.) <a data-type="xref" href="#informalfigure_with_textobject">???</a> and <a data-type="xref" href="#inlinemediaobject_with_textobject">???</a> show examples of the markup for an <code>informalfigure</code> and <code>inlinemediaobject</code> with custom <code>alt</code> text.</p>

<div data-type="example" id="informalfigure_with_textobject">
<h5>informalfigure with textobject</h5>

<pre data-type="programlisting">
&lt;informalfigure id="informalfigure_with_custom_alt_text"&gt;
  &lt;mediaobject&gt;
    &lt;imageobject&gt;
      &lt;imagedata fileref="images/universal_design_for_web_applications_cover.png"
                    width="2.4in"/&gt;
    &lt;/imageobject&gt;

    &lt;textobject&gt;
      &lt;phrase&gt;Universal Design for Web Applications Cover&lt;/phrase&gt;
    &lt;/textobject&gt;
 &lt;/mediaobject&gt;
&lt;/informalfigure&gt;</pre>
</div>

<div data-type="example" id="inlinemediaobject_with_textobject">
<h5>inlinemediaobject with textobject</h5>

<pre data-type="programlisting">
&lt;inlinemediaobject&gt;
  &lt;imageobject&gt;
    &lt;imagedata fileref="images/oreilly_logo.png" width="0.12in"/&gt;
  &lt;/imageobject&gt;
  &lt;textobject&gt;
    &lt;phrase&gt;O’Reilly Media, Inc. logo&lt;/phrase&gt;
  &lt;/textobject&gt;
&lt;/inlinemediaobject&gt;</pre>
</div>

<div data-type="tip" id="id-YbeuG"><h6>Tip</h6>
<p>For some tips on writing good <code>alt</code> text, O’Reilly’s <a href="http://oreilly.com/catalog/9780596518745/"><em>Universal Design for Web Applications</em></a> is a great resource. In particular, see the section, “Keys to Writing Good Text Alternatives,” which <a href="http://my.safaribooksonline.com/9780596155681/keys_to_writing_good_text_alternatives">is available on Safari</a>. We’d also be happy to supply you with a PDF or EPUB of the book on request.</p>
</div>
</section>
</section>

<section data-type="sect2" id="tables-Kmkte">
<h2>Tables</h2>

<p>If your table requires a description, you expect to refer to it later elsewhere in the text, or it’s especially complex, you probably want to use a <code>table</code> element. Otherwise, consider using an <code>informaltable</code>.</p>

<section data-type="sect3" id="formal-tables-mZWSY">
<h3>Formal tables</h3>

<p>Here’s the markup for a <code>table</code> with a header:</p>

<pre data-type="programlisting">
&lt;table id="example_table"&gt;
&lt;title&gt;Example formal table&lt;/title&gt;
  &lt;tgroup cols="2"&gt;
    &lt;thead&gt;
      &lt;row&gt;
        &lt;entry&gt;Heading1&lt;/entry&gt;
        &lt;entry&gt;Heading2&lt;/entry&gt;
      &lt;/row&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;row&gt;
        &lt;entry&gt;Text1&lt;/entry&gt;
        &lt;entry&gt;Text2&lt;/entry&gt;
      &lt;/row&gt;
      &lt;row&gt;
        &lt;entry&gt;Text3&lt;/entry&gt;
        &lt;entry&gt;Text4&lt;/entry&gt;
      &lt;/row&gt;
    &lt;/tbody&gt;
  &lt;/tgroup&gt;
&lt;/table&gt;</pre>

<p><a data-type="xref" href="#example_table">???</a> shows how it renders.</p>

<table id="example_table">
	<caption>Example formal table</caption>
	<thead>
		<tr>
			<th>Heading1</th>
			<th>Heading2</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Text1</td>
			<td>Text2</td>
		</tr>
		<tr>
			<td>Text3</td>
			<td>Text4</td>
		</tr>
	</tbody>
</table>

<p>Note that the title describes the entire table, while the header contains information about each column. A formal table does not always need to have to have a header.</p>

<p>Tables can get <em>much</em> more complex than this example. See <a href="http://www.docbook.org/tdg/en/html/table.html">http://www.docbook.org/tdg/en/html/table.html</a> for details, though please note that not everything discussed there will work with our toolchain or conform to O’Reilly’s style (check with your editor about the latter).</p>
</section>

<section data-type="sect3" id="informal-tables-e3gTW">
<h3>Informal tables</h3>

<p>The markup of an <code>informaltable</code> is similar to that of a <code>table</code>, but it does not have a <code>title</code> or need an <code>id</code>. Here’s an example.</p>

<table>
	<tbody>
		<tr>
			<td>Text1</td>
			<td>Text2</td>
		</tr>
		<tr>
			<td>Text3</td>
			<td>Text4</td>
		</tr>
	</tbody>
</table>

<p>This particular informal table doesn’t have a header (no <code>thead</code>), but it would be valid to add one. Also, the bottom rule has been suppressed with the use of a <code>frame="none"</code> attribute; see the next section for details on table borders.</p>

<div data-type="note" id="id-e3Acd"><h6>Note</h6>
<p>Please check with your editor about O’Reilly house style before overriding table defaults, as table markup can be quite labor-intensive for you or Production staff to change later on.</p>
</div>
</section>

<section data-type="sect3" id="frames-and-borders-mnWSY">
<h3>Frames and borders</h3>

<p>You can adjust the appearance of the frames and borders in table elements. To control the lines surrounding the <code>&lt;table&gt;</code> element itself, you can set the <code>frame</code> attribute:</p>

<dl>
	<dt><code>frame</code></dt>
	<dd>
	<p>A value of <code>all</code> means all sides will be black. A value of <code>none</code> means the bottom rule will be suppressed.</p>
	</dd>
</dl>

<p>To control the interior cell borders, you can set <code>colsep</code> and <code>rowsep</code> attributes on various elements inside the table:</p>

<dl>
	<dt><code>colsep</code></dt>
	<dd>
	<p>A value of <code>1</code> draws a rule to the right of the element. A value of <code>0</code> suppresses the rule.</p>
	</dd>
	<dt><code>rowsep</code></dt>
	<dd>
	<p>A value of <code>1</code> draws a rule below the element. A value of <code>0</code> suppresses the rule.</p>
	</dd>
</dl>
</section>
</section>

<section data-type="sect2" id="lists-xrpiY">
<h2>Lists</h2>

<p>There are four common types of lists. The <a href="http://oreilly.com/oreilly/author/stylesheet.html#lists">O’Reilly Stylesheet and Word List</a> has more details about when to use them, but here’s the markup and an example of each.</p>

<section data-type="sect3" id="simple-lists-2EVf8">
<h3>Simple lists</h3>

<p>Markup:</p>

<pre data-type="programlisting">
&lt;simplelist&gt;
  &lt;member&gt;This is a list of several short items.&lt;/member&gt;
  &lt;member&gt;Usually one or a few words each.&lt;/member&gt;
&lt;/simplelist&gt;</pre>

<p>Rendering:</p>

<ul class="simplelist">
	<li>This is a list of several short items.</li>
	<li>Usually one or a few words each.</li>
</ul>
</section>

<section data-type="sect3" id="bulleted-aka-itemized-lists-O82f9">
<h3>Bulleted (aka itemized) lists</h3>

<p>Markup:</p>

<pre data-type="programlisting">
&lt;itemizedlist&gt;
  &lt;listitem&gt;&lt;para&gt;This is a list.&lt;/para&gt;&lt;/listitem&gt;
  &lt;listitem&gt;&lt;para&gt;With bullets.&lt;/para&gt;&lt;/listitem&gt;
&lt;itemizedlist&gt;</pre>

<p>Rendering:</p>

<ul>
	<li>
	<p>This is a list.</p>
	</li>
	<li>
	<p>With bullets.</p>
	</li>
</ul>

<p>In the case of an <code>itemizedlist</code> nested in an <code>itemizedlist</code>, the child list will use em dashes in place of bullets. If you want to use symbols other than em dashes or bullets, you can set the symbol for an entire <code>itemizedlist</code> by using the <code>mark</code> attribute, or for a single <code>listitem</code> by using the <code>override</code> attribute. For instance, <code>&lt;itemizedlist mark="emdash"&gt;</code> causes an entire list to render with the mark “—" instead of standard bullets. Other options include <code>endash</code> (–), <code>square</code> (■), <code>circle</code> (○), and <code>whitesquare</code> (□).</p>

<p>Again, check with your editor about O’Reilly house style before changing the defaults.</p>
</section>

<section data-type="sect3" id="numbered-aka-ordered-lists-5zAFg">
<h3>Numbered (aka ordered) lists</h3>

<p>Markup:</p>

<pre data-type="programlisting">
&lt;orderedlist&gt;
  &lt;listitem&gt;&lt;para&gt;This list uses numbers.&lt;/para&gt;&lt;/listitem&gt;
  &lt;listitem&gt;&lt;para&gt;Instead of bullets.&lt;/para&gt;&lt;/listitem&gt;
&lt;orderedlist&gt;</pre>

<p>Rendering:</p>

<ol>
	<li>
	<p>This list uses numbers.</p>
	</li>
	<li>
	<p>Instead of bullets.</p>
	</li>
</ol>

<p>To continue the numbering of an <code>orderedlist</code> from a previous list, use a <code>continuation</code> attribute with a value of <code>continues</code>:</p>

<pre data-type="programlisting">
&lt;orderedlist continuation="continues"&gt;</pre>

<p>The default is <code>continuation="restarts"</code>. This causes the numbering to begin at 1.</p>

<p>If an <code>orderedlist</code> has other lists nested within it, <code>&lt;orderedlist contin⁠uation="continues"&gt;</code> may cause them to start at the wrong number. In these cases you can add an <code>override</code> attribute with the number at which you’d like the incorrectly numbered <code>listitem</code> to start. Your continued <code>orderedlist</code> will then begin at that number.</p>
</section>

<section data-type="sect3" id="labeled-aka-variable-or-term-definition-lists-leBfR">
<h3>Labeled (aka variable or term-definition) lists</h3>

<p>A variable list is made up of pairs of items.</p>

<p>Markup:</p>

<pre data-type="programlisting">
&lt;variablelist&gt;
  &lt;varlistentry&gt;
    &lt;term&gt;The first part could be a term&lt;/term&gt;
    &lt;listitem&gt;&lt;para&gt;Followed by a definition.&lt;/para&gt;&lt;/listitem&gt;
  &lt;/varlistentry&gt;
  &lt;varlistentry&gt;
    &lt;term&gt;Or a name&lt;/term&gt;
    &lt;listitem&gt;&lt;para&gt;Followed by a description. Etc.&lt;/para&gt;&lt;/listitem&gt;
  &lt;/varlistentry&gt;
&lt;/variablelist&gt;</pre>

<p>Rendering:</p>

<dl>
	<dt>The first part could be a term</dt>
	<dd>
	<p>Followed by a definition.</p>
	</dd>
	<dt>Or a name</dt>
	<dd>
	<p>Followed by a description, etc.</p>
	</dd>
</dl>

<p>By default, the list <code>term</code> will render in italics. To remove the italics, add a <code>role</code> attribute of <code>plain</code>:</p>

<pre data-type="programlisting">
&lt;term role="plain"&gt;Variable list term&lt;/term&gt;</pre>
</section>
</section>

<section data-type="sect2" id="notes-warnings-and-sidebars-Dx6Cb">
<h2>Notes, Warnings, and Sidebars</h2>

<p>You may use these block elements for adding supplemental information or warnings to the reader.</p>

<div data-type="note" id="id-ZdZUx"><h6>Note</h6>
<p>The <code>tip</code> element will render the same as a <code>note</code>.</p>
</div>

<div data-type="warning" id="id-ojns3"><h6>Warning</h6>
<p>The <code>caution</code> element will render the same as a <code>warning</code>.</p>
</div>

<p>Notes and warnings may contain paras, code blocks, and lists. They should <em>not</em> contain figures, tables, or examples.</p>

<aside data-type="sidebar" id="when-to-use-a-sidebar-GrOHZ">
<h5>When to Use a Sidebar?</h5>

<p>If a note or a warning covers a lot of information or includes complex elements, consider using a sidebar instead. A sidebar can be much longer—even spanning several <span class="keep-together">pages—</span>and must have a title. It may contain tables and examples, but per house style it should not contain figures.</p>
</aside>
</section>

<section data-type="sect2" id="inserting_hyperlinks">
<h2>Hyperlinks</h2>

<p>The element for URLs is <code>ulink</code>. Here are the traditional markup options:</p>

<dl>
	<dt>No CDATA</dt>
	<dd>
	<pre data-type="programlisting">
&lt;ulink url="http://www.oreilly.com"/&gt;</pre>

	<p>Looks like: <a href="http://www.oreilly.com">http://www.oreilly.com</a></p>
	</dd>
	<dt>With CDATA different from <code>url</code></dt>
	<dd>
	<pre data-type="programlisting">
&lt;ulink url="http://www.oreilly.com"&gt;O'Reilly&lt;/ulink&gt;</pre>

	<p>Looks like: <a href="http://www.oreilly.com">O’Reilly</a></p>
	</dd>
</dl>

<p>We ask that you anchor your links to text wherever possible. Here’s an example:</p>

<pre data-type="programlisting">
&lt;para&gt;&lt;ulink url="http://www.macports.org"&gt;MacPorts&lt;/ulink&gt; is a great tool for 
installing open source software on OS X.&lt;/para&gt;</pre>

<p>In the PDF you build in Atlas (which reflects the version we’ll publish on <a href="http://oreilly.com">http://oreilly.com</a> and other digital channels), the hyperlink will be clickable and display in red, like so:</p>

<figure style="float: 0" id="id-bnaFJ"><img src="images/hyperlink_web.png">
<figcaption>&nbsp;</figcaption>
</figure>

<p>In the print book, the URL will render in parentheses following the text, like so:</p>

<figure style="float: 0" id="id-9Resr"><img src="images/hyperlink_print.png">
<figcaption>&nbsp;</figcaption>
</figure>

<p>Here’s an example of what <em>not</em> to do:</p>

<pre data-type="programlisting">
&lt;para&gt;Macports (&lt;ulink url="http://www.macports.org"/&gt;) is a great tool for 
installing open source software on OS X.&lt;/para&gt;</pre>

<p>We also recommend using <a href="https://bitly.com/">bit.ly</a> links instead of long URLs. This will improve the reading experience in print versions of the book.</p>

<p>When you create <code>ulink</code>s, make sure the <code>url</code> attribute contains a full URL, including the protocol—e.g., use <em>http://www.macports.org</em> instead of <em>www.macports.org</em>. The <code>ulink</code> is not valid without the protocol.</p>

<div data-type="note" id="id-Va7fK"><h6>Note</h6>
<p>Don’t use <code>ulink</code> markup for fake or example URLs, as the hyperlinks may confuse readers (and link-harvesting tools that may be used on your content downstream). Instead, use <code>emphasis</code> or <code>uri</code> as semantically appropriate.</p>
</div>
</section>

<section data-type="sect2" id="footnotes-qZqSz">
<h2>Footnotes</h2>

<p>A <code>footnote</code> generates a superscript number wherever it is placed in the text, and the body of the footnote appears at the bottom of the page.<span data-type="footnote">Like this.</span> Table footnotes are lettered and appear directly after the table (not at the bottom of the page). For example:</p>

<table>
	<tbody>
		<tr>
			<td>Here is some text.<sup class="table-footnote-call">a</sup></td>
			<td>A bit more text.</td>
		</tr>
		<tr>
			<td>This is text.</td>
			<td>You get the idea.<sup class="table-footnote-call">b</sup></td>
		</tr>
	</tbody>
</table>

<div class="table-footnotes">
<p><sup class="table-footnote-marker">a</sup><span class="table-footnote-text">Here’s a table footnote.</span></p>

<p><sup class="table-footnote-marker">b</sup><span class="table-footnote-text">Here’s another.</span></p>
</div>

<p>Footnotes should generally be inserted <em>after</em> punctuation. See the <a href="http://oreilly.com/oreilly/author/stylesheet.html#footnotes">O’Reilly Stylesheet and Word List</a> for guidelines.</p>

<p>We may be able to support the use of symbols instead of numbers for non-table footnotes via a stylesheet customization. Please check with your editor whether this is appropriate for your book.</p>
</section>

<section data-type="sect2" id="indexing-z8kC6">
<h2>Indexing</h2>

<p>O’Reilly provides professional indexing as a normal part of Production, but if for some reason you’d like to add index markers yourself, this section covers the proper markup. See the <a href="http://chimera.labs.oreilly.com/books/1234000001578/index.html">O'Reilly Indexing Guidelines</a> for complete details.</p>

<p>To include an index in your PDF, add a line that says <code>&lt;index/&gt;</code> to your <code data-type="filename">book.xml</code> file before the closing <code>&lt;/book&gt;</code> tag, like so:</p>

<pre data-type="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" 
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"&gt;
&lt;book role="animal"&gt;
&lt;title&gt;Some Fantastic Book&lt;/title&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="dedication.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="bookinfo.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch00.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch01.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch02.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch03.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch04.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="ch05.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appa.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appb.xml"/&gt;
&lt;xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="appc.xml"/&gt;
&lt;index/&gt;
&lt;/book&gt;</pre>

<p>It’s also helpful if you add a <code>remark</code> element somewhere explaining to Production whether you’re merely adding a few terms that you’d like a professional indexer to incorporate, or whether you’re creating a complete index. Discuss these options with your editor first.</p>

<p>Here’s the basic index entry markup:</p>

<pre data-type="programlisting">
&lt;indexterm&gt;&lt;primary&gt;index entry syntax, level 1&lt;/primary&gt;&lt;/indexterm&gt;</pre>

<p>Secondary entry (subentry) markup:</p>

<pre data-type="programlisting">
&lt;indexterm&gt;
    &lt;primary&gt;index entry syntax&lt;/primary&gt;
    &lt;secondary&gt;for a subentry&lt;/secondary&gt;
&lt;/indexterm&gt;</pre>

<p>Tertiary entry (sub-subentry) markup:</p>

<pre data-type="programlisting">
&lt;indexterm&gt;
    &lt;primary&gt;index entry syntax&lt;/primary&gt;
    &lt;secondary&gt;for a subentry&lt;/secondary&gt;
    &lt;tertiary&gt;with a subentry&lt;/tertiary&gt;
&lt;/indexterm&gt;</pre>

<p>Index entry with a range markup:</p>

<pre data-type="programlisting">
This book is full of geeky text with DocBook XML markup, which starts here:
&lt;indexterm class="startofrange" id="geekytext"&gt;
&lt;primary&gt;geeky DocBook XML text&lt;/primary&gt;&lt;/indexterm&gt;blah blah blah Ajax
blah blah blah Ruby on Rails
...
and ends here&lt;indexterm class="endofrange" startref="geekytext"&gt;.</pre>

<div data-type="note" id="id-p6xFz"><h6>Note</h6>
<p>The closing <code>indexterm</code> tag does not contain a <code>primary</code> or <code>secondary</code> entry, just a <code>startref</code> attribute that references the starting <code>indexterm</code> entry. Do not place the closing tag on its own line.</p>
</div>
</section>
</section>

<section data-type="sect1" id="code-R6pcb">
<h1>Code</h1>

<p>In general, put your code snippets in <code>programlisting</code> or <code>screen</code> elements. These render exactly the same—the choice is yours. Here’s a very simple one:</p>

<pre data-type="programlisting">
Hello World</pre>

<p>If you have larger blocks of code that you want to have a title, a number, and a cross-reference, use an <code>example</code> element. <a data-type="xref" href="#sample_example">???</a> shows a basic one.</p>

<div data-type="example" id="sample_example">
<h5>Sample example</h5>

<pre data-type="programlisting">
Hello World</pre>
</div>

<p>These elements are verbatim environments, which means whitespace is preserved in rendered versions. You must either escape all characters that have special meaning in XML (such as <code>&lt;</code> and <code>&gt;</code>—these characters obviously come up quite a bit in code) or use a <code>CDATA</code> block.<span data-type="footnote">You can use a <code>CDATA</code> section as long as you don’t need inline markup within the code (see <a data-type="xref" href="#verbatim_caveats">???</a>). In a <code>CDATA</code> section, any text between <code>&lt;![CDATA[</code> and <code>]]&gt;</code> is ignored by the XML parser. You can’t use <code>CDATA</code> sections if you’re using XXE, but on the other hand, you also won’t need to worry about escaping special characters (as XXE takes care of that for you), which is probably the better end of the bargain.</span></p>

<section data-type="sect2" id="external-code-files-K6due">
<h2>External code files</h2>

<p>If you want to manage your code in separate files from the manuscript, you can use <code>&lt;xi:include&gt;</code> tags to point to your code (more on <code>XInclude</code>s in <a data-type="xref" href="#organizing_files">???</a>). If you do this, the parser doesn’t try to interpret them as XML, but you must include a <code>parse="text"</code> attribute:</p>

<pre data-type="programlisting">
&lt;programlisting&gt;
&lt;xi:include 
  xmlns:xi="http://www.w3.org/2001/XInclude" 
  parse="text" href="hello.c" /&gt;
&lt;/programlisting&gt;</pre>

<p>Please be aware that once the book is in Production, we will run a script that pulls all included code into the chapter files, and the <code>XInclude</code> links will be gone.</p>
</section>

<section data-type="sect2" id="verbatim_caveats">
<h2>Caveats</h2>

<p>Although inline markup and newlines within verbatim environments<span data-type="footnote">E.g., <code>programlisting</code>s or <code>screen</code>s, used for code blocks where line breaks and spaces need to be preserved.</span> are valid DocBook, we ask that you follow these guidelines to prevent rendering problems downstream.</p>

<section data-type="sect3" id="long-code-lines-gWni0">
<h3>Long Code Lines</h3>

<p>The allowed number of characters per line of code varies depending on the book series and where the code is positioned in the markup. The following table lists some common cases.<span data-type="footnote">These values apply to Atlas-generated PDFs only. Please see the <a href="https://prod.oreilly.com/external/tools/docbook/docs/authoring/html/docbookguidelines.html#maximum_widths">old guidelines</a> for max characters in SVN-generated PDFs.</span></p>

<div data-type="note" id="id-l1jCL"><h6>Note</h6>
<p>Please keep in mind that these are just the <em>maximum</em> characters <span class="keep-together">allowed</span>. You should review your PDFs and make your own judgments about the best way to present code to the reader.</p>
</div>

<table>
	<thead>
		<tr>
			<th>Series</th>
			<th>Body (top-level code)</th>
			<th>Examples</th>
			<th>Lists</th>
			<th>Sidebars/notes/warnings</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Animal or Cookbook</td>
			<td>85</td>
			<td>90</td>
			<td>80</td>
			<td>80</td>
		</tr>
		<tr>
			<td>Small Animal (6x9)</td>
			<td>76</td>
			<td>80</td>
			<td>72</td>
			<td>70</td>
		</tr>
		<tr>
			<td>Theory in Practice</td>
			<td>85</td>
			<td>90</td>
			<td>80</td>
			<td>72</td>
		</tr>
		<tr>
			<td>Nutshell</td>
			<td>76</td>
			<td>80</td>
			<td>72</td>
			<td>66</td>
		</tr>
		<tr>
			<td>Pocket Reference</td>
			<td>58</td>
			<td>62</td>
			<td>53</td>
			<td>48</td>
		</tr>
		<tr>
			<td>Hacks</td>
			<td>76</td>
			<td>80</td>
			<td>72</td>
			<td>70</td>
		</tr>
	</tbody>
</table>

<p>Please rebreak any code lines that exceed the max number of characters; otherwise, the code will run into the margin in your PDFs, which is unacceptable for print. It’s best to fix long code lines in the manuscript stage, while you still have access to the source. Making such edits during Production is much more cumbersome for everyone involved.</p>
</section>

<section data-type="sect3" id="tabs-vo4Hp">
<h3>Tabs</h3>

<p>Please don’t use tabs in code blocks, as tabs don’t necessarily translate to the same amount of space on different systems. To align or indent within your code, use spaces.</p>
</section>

<section data-type="sect3" id="inline-markup-on-multiple-lines-4xPtl">
<h3>Inline markup on multiple lines</h3>

<p>When using inline markup on multiple lines of code (e.g., <code>&lt;emphasis role="bold"&gt;</code>), <em>please close the tag at the end of each line and open a new one on the next line</em>. For example, instead of this:</p>

<pre data-type="programlisting">
&lt;programlisting&gt;&lt;emphasis role="bold"&gt;GLuint m_gridTexture;
IResourceManager* m_resourceManager;
&lt;/emphasis&gt;};&lt;/programlisting&gt;</pre>

<p>do this:</p>

<pre data-type="programlisting">
&lt;programlisting&gt;&lt;emphasis role="bold"&gt;GLuint m_gridTexture;&lt;/emphasis&gt;
&lt;emphasis role="bold"&gt;IResourceManager* m_resourceManager;&lt;/emphasis&gt;
};&lt;/programlisting&gt;</pre>

<p>Failing to do this can cause headaches and delays in Production.</p>
</section>

<section data-type="sect3" id="newlines-3YnUp">
<h3>Newlines</h3>

<p>Be careful not to add newlines to the beginning or end of code blocks. Because all line breaks are preserved in verbatim blocks, newlines can result in excess whitespace. For example, the following listing will render with unwanted blank lines at the top and bottom due to the line breaks after the opening <code>&lt;programlisting&gt;</code> tag and before the closing <code>&lt;/programlisting&gt;</code> tag:</p>

<pre data-type="programlisting">
&lt;programlisting&gt;
CLLocationManager *locationManager = [[CLLocationManager alloc] init];
locationManager.delegate = self;
    [locationManager startUpdatingLocation];
} else {
    NSLog(@"Location services not enabled.");
}
&lt;/programlisting&gt;</pre>

<p>Although we have tools to remove the extraneous whitespace once the files are in Production, we prefer not to run global changes on code content, so it’s best if you avoid adding it in the first place. Do this instead:</p>

<pre data-type="programlisting">
&lt;programlisting&gt;CLLocationManager *locationManager = [[CLLocationManager alloc] init];
locationManager.delegate = self;
    [locationManager startUpdatingLocation];
} else {
    NSLog(@"Location services not enabled.");
}&lt;/programlisting&gt;</pre>
</section>
</section>

<section data-type="sect2" id="callouts-lj3IR">
<h2>Callouts</h2>

<p>If you want to have cross-references to specific lines of code, you can use callouts. Just put a <code>co</code> element at the end of each line you want to reference—these will generate callout markers. Then create a <code>calloutlist</code> element after the code block. This list contains <code>callout</code> items that discuss or explain each referenced line.</p>

<p>Here is an example of the markup:</p>

<pre data-type="literallayout">
&lt;screen&gt;&lt;programlisting&gt; &lt;co id="opening_tag_co"
          linkends="opening_tag" /&gt;
&lt;xi:include &lt;co id="xinclude_co" linkends="xinclude" /&gt; 
  xmlns:xi="http://www.w3.org/2001/XInclude" 
  parse="text" href="hello.c" /&gt;
&lt;/programlisting&gt; &lt;co id="closing_tag_co" linkends="closing_tag" /&gt;
      
&lt;calloutlist&gt;
  &lt;callout arearefs="opening_tag_co" id="opening_tag"&gt;
    &lt;para&gt;The opening tag for a &lt;literal&gt;programlisting&lt;/literal&gt; element.&lt;/para&gt;
  &lt;/callout&gt;

  &lt;callout arearefs="xinclude_co" id="xinclude"&gt;
    &lt;para&gt;An &lt;literal&gt;XInclude&lt;/literal&gt;.&lt;/para&gt;
  &lt;/callout&gt;

  &lt;callout arearefs="closing_tag_co" id="closing_tag"&gt;
    &lt;para&gt;The closing tag for a &lt;literal&gt;programlisting&lt;/literal&gt; element.&lt;/para&gt;
  &lt;/callout&gt;
&lt;/calloutlist&gt;&lt;/screen&gt;</pre>

<p>And here's how it will render:</p>

<pre data-type="programlisting">
&lt;programlisting&gt; <a class="co" href="#callout_opening_tag_co" id="co_opening_tag_co">???</a>
&lt;xi:include <a class="co" href="#callout_xinclude_co" id="co_xinclude_co">???</a> 
  xmlns:xi="http://www.w3.org/2001/XInclude" 
  parse="text" href="hello.c" /&gt;
&lt;/programlisting&gt; <a class="co" href="#callout_closing_tag_co" id="co_closing_tag_co">???</a></pre>

<dl class="calloutlist">
	<dt><a class="co" href="#co_opening_tag_co" id="callout_opening_tag_co">???</a></dt>
	<dd>
	<p>The opening tag for a <code>programlisting</code> element.</p>
	</dd>
	<dt><a class="co" href="#co_xinclude_co" id="callout_xinclude_co">???</a></dt>
	<dd>
	<p>An <code>XInclude</code>.</p>
	</dd>
	<dt><a class="co" href="#co_closing_tag_co" id="callout_closing_tag_co">???</a></dt>
	<dd>
	<p>The closing tag for a <code>programlisting</code> element.</p>
	</dd>
</dl>

<p>Each <code>co</code> element in the code block includes an optional <code>linkends</code> attribute that points to the <code>callout</code> elements that refer to it, forming a link between the marker and the callout. Conversely, each <code>callout</code> element requires an <code>arearefs</code> attribute that points to <code>co</code> elements, forming a link between the callout and the marker. The markers will be rendered as clickable bidirectional cross-references if you use this markup.</p>

<p>The markup for the above looks like this:</p>

<pre data-type="programlisting">
&lt;screen&gt;&amp;lt;programlisting&amp;gt; &lt;co id="opening_tag_co" 
  linkends="opening_tag"/&gt;
&amp;lt;xi:include &lt;co id="xinclude_co" linkends="xinclude"/&gt; 
  xmlns:xi="http://www.w3.org/2001/XInclude" 
  parse="text" href="hello.c" /&amp;gt;
&amp;lt;/programlisting&amp;gt; &lt;co id="closing_tag_co" linkends="closing_tag"/&gt;
&lt;/screen&gt;

&lt;calloutlist&gt;
&lt;callout arearefs="opening_tag_co" id="opening_tag"&gt;
&lt;para&gt;The opening tag for a &lt;literal&gt;programlisting&lt;/literal&gt;
element.&lt;/para&gt;
&lt;/callout&gt;

&lt;callout arearefs="xinclude_co" id="xinclude"&gt;
&lt;para&gt;An &lt;literal&gt;XInclude&lt;/literal&gt;.&lt;/para&gt;
&lt;/callout&gt;

&lt;callout arearefs="closing_tag_co" id="closing_tag"&gt;
&lt;para&gt;The closing tag for a &lt;literal&gt;programlisting&lt;/literal&gt;
element.&lt;/para&gt;
&lt;/callout&gt;
&lt;/calloutlist&gt;</pre>

<p>For more information on DocBook callout markup, see <a href="http://www.sagehill.net/docbookxsl/AnnotateListing.html#Callouts">http://www.sagehill.net/docbookxsl/AnnotateListing.html#Callouts</a>. Please note that our toolchain does not support <code>areaspec</code>/<code>area</code>/<code>areaset</code> elements to specify callout regions.</p>

<div data-type="note" id="id-0WOFg"><h6>Note</h6>
<p>Although DocBook has markup for adding line numbers and annotations directly to code, O’Reilly’s toolchain doesn’t support these options. Line numbers don’t allow for good cross-referencing and can potentially cause problems if code is revised and line numbers change. If you want to cross-reference code blocks by number, we recommend using <span class="keep-together">callouts</span> instead; they are autonumbered and will adjust automatically if you shift code around.</p>
</div>
</section>

<section data-type="sect2" id="syntax-highlighting-Mm7I6">
<h2>Syntax Highlighting</h2>

<p>The Atlas toolchain now supports syntax highlighting via <a href="http://pygments.org/">Pygments</a>, and we recommend that all authors use it when possible. All you need to do is add a <code>language</code> attribute to each code block that should include syntax highlighting, and specify the language of the code. For example:</p>

<pre data-type="programlisting">
&lt;programlisting language="java"&gt;int radius = 40;
float x = 110;
float speed = 0.5;
int direction = 1;&lt;/programlisting&gt;</pre>

<p>Here’s how it renders:</p>

<pre data-code-language="java" data-type="programlisting">
int radius = 40;
float x = 110;
float speed = 0.5;
int direction = 1;</pre>

<p>Pygments supports a wide variety of languages that can be used in the <code>language</code> attribute; see the full list at <a href="http://pygments.org/docs/lexers/">http://pygments.org/docs/lexers</a>. Ebook readers that do not have color screens will still display the highlighting, but in more subtle shades of gray.</p>

<p>Please note the following caveats:</p>

<ul>
	<li>
	<p>The color scheme is consistent across books and cannot be changed at this time.</p>
	</li>
	<li>
	<p>This feature is supported in EPUB, ebook PDFs, and KF8 for the Kindle Fire. Syntax highlighting is not supported in print books unless it’s printing in color.</p>
	</li>
</ul>

<p>If you would like to do something that’s not currently supported, please write to us at <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a> and we’ll do our best to work with you on incorporating it.</p>
</section>
</section>

<section data-type="sect1" id="unicode">
<h1>Unicode for Special Characters</h1>

<p>For nonstandard characters, use Unicode. The following table provides the values for some common characters; for all others, use the <a href="http://www.fileformat.info/info/unicode/char/search.htm">Unicode Char⁠acter Search</a> (but keep in mind that our default fonts don’t have glyphs for every exotic character; send email to <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a> if you have questions about this). If you’re using XXE with the ORM customizations file, most of the characters below have keyboard shortcuts.</p>

<p>To add a Unicode character directly to XML in a text editor, use the entity <code>&amp;#x<em><code>CODEPOINT</code></em>;</code>, where <em><code>CODEPOINT</code></em> is the four-digit hexadecimal number after U+ (e.g., for <span class="keep-together">U+20A0</span>, enter <code>&amp;#x20A0;</code>). Letters that are part of the codepoint may be entered as either upper- or lowercase (i.e., <code>&amp;#x03bb;</code> is the same as <code>&amp;#x03BB;</code>), but the <code>x</code> between the <code>#</code> symbol and the codepoint must be lowercase.</p>

<table>
	<thead>
		<tr>
			<th>Character</th>
			<th>Unicode value (hexadecimal codepoint)</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>— (Em Dash)</td>
			<td>U+2014</td>
		</tr>
		<tr>
			<td>- (En Dash)</td>
			<td>U+2013</td>
		</tr>
		<tr>
			<td>“ (Curly Left Double Quotation Mark)</td>
			<td>U+201C</td>
		</tr>
		<tr>
			<td>” (Curly Right Double Quotation Mark)</td>
			<td>U+201D</td>
		</tr>
		<tr>
			<td>‘ (Curly Left Single Quotation Mark)</td>
			<td>U+2018</td>
		</tr>
		<tr>
			<td>’ (Curly Right Single Quotation Mark)</td>
			<td>U+2019</td>
		</tr>
		<tr>
			<td>× (MathMultiplier)</td>
			<td>U+00D7</td>
		</tr>
		<tr>
			<td>→ (CharMenuDelim)</td>
			<td>U+2192</td>
		</tr>
		<tr>
			<td>€ (Euro Currency Symbol)</td>
			<td>U+20A0</td>
		</tr>
		<tr>
			<td>✓ (Check Mark)</td>
			<td>U+2713</td>
		</tr>
		<tr>
			<td>✗ (Ballot X)</td>
			<td>U+2717</td>
		</tr>
		<tr>
			<td>⌘ (Place Of Interest Sign)</td>
			<td>U+2318</td>
		</tr>
		<tr>
			<td>↵ (Carriage Return Arrow)</td>
			<td>U+21B5</td>
		</tr>
	</tbody>
</table>
</section>

<section data-type="sect1" id="adding_comments">
<h1>Comments and Remarks</h1>

<p>You have two options for adding comments to your manuscript: standard XML comments (<code>&lt;!--</code><code>foo--&gt;</code>) and <code>remark</code> elements.</p>

<p>XML comments are useful for commenting out large blocks of text—for example, text that is under review, or text that you don’t currently want to include in your manuscript. In the following example, the entire paragraph is commented out:</p>

<pre data-type="programlisting">
&lt;!-- O’Reilly’s mission statement. 
&lt;para&gt;O’Reilly Media spreads the knowledge of innovators through its books, 
online services, magazines, research, and conferences. Since 1978, O’Reilly 
has been a chronicler and catalyst of leading-edge development, homing in 
on the technology trends that really matter and galvanizing their adoption 
by amplifying “faint signals” from the alpha geeks who are creating the future. 
An active participant in the technology community, the company has a long 
history of advocacy, meme-making, and evangelism.&lt;/para&gt; --&gt;</pre>

<p><code>remark</code> elements are better for directing specific comments to the editor or Production. For example:</p>

<pre data-type="programlisting">
&lt;remark&gt;PRODUCTION: Please stet grammatical errors in the following&lt;/remark&gt;

&lt;para&gt;I can haz cheezburger, plz?&lt;/para&gt;</pre>

<p>If you have comments for Production staff, we would appreciate you formatting them as <code>remark</code> elements and starting them with “PRODUCTION,” as shown above. This is helpful for distinguishing comments that need to be addressed during Production from comments directed toward editorial staff or coauthors.</p>

<p>By default, comments are not displayed in your PDF builds. If you’d like them to appear while you’re working on the book, let us know at <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a>.</p>
</section>

<section data-type="sect1" id="quotes-and-epigraphs-9KWS7">
<h1>Quotes and Epigraphs</h1>

<p>To add a quote anywhere in your book, use the <code>blockquote</code> element. Since it’ll be set apart from the text, there’s no need to put quotation marks around it. Here’s some example markup—a quote attributed to Benjamin Disraeli (by Wilfred Meynell, according to Frank Muir):</p>

<pre data-type="programlisting">
&lt;blockquote&gt;
  &lt;attribution&gt;Wilfred Meynell&lt;/attribution&gt;

  &lt;para&gt;Many thanks; I shall lose no time in reading it.&lt;/para&gt;
&lt;/blockquote&gt;</pre>

<p>Here’s how it renders:</p>

<blockquote>
<p>Many thanks; I shall lose no time in reading it.</p>

<p data-type="attribution">Wilfred Meynell</p>
</blockquote>

<p>If you want to add a quote at the <em>beginning</em> of your chapters (or sections, parts, etc.), use the <code>epigraph</code> element. Here’s some example markup:</p>

<pre data-type="programlisting">
&lt;epigraph&gt;
  &lt;attribution&gt;Robert Benchley&lt;/attribution&gt;

  &lt;para&gt;There are two kinds of people in the world: those who believe 
  there are two kinds of people in the world, and those who don't.&lt;/para&gt;
&lt;/epigraph&gt;</pre>

<p>And here’s how it renders:</p>

<blockquote data-type="epigraph">
<p>There are two kinds of people in the world: those who believe there are two kinds of people in the world, and those who don’t.</p>

<p data-type="attribution">Robert Benchley</p>
</blockquote>
</section>

<section data-type="sect1" id="math_in_docbook">
<h1>Math in DocBook</h1>

<p>For complex math, the Atlas system now supports LaTeX and MathML—details on these below. However, it’s best to use regular text whenever possible for writing simple equations and expressions.<span data-type="footnote">For any platforms or devices where LaTeX/MathML is not supported, our toolchain automatically converts to images.</span></p>

<section data-type="sect2" id="simple-math-d3xIe">
<h2>Simple Math</h2>

<p>Use regular text set in <code>equation</code> elements for any math you can type using the following:</p>

<ul>
	<li>
	<p>Standard keyboard characters</p>
	</li>
	<li>
	<p><sup>Superscripts</sup> and/or <sub>subscripts</sub></p>
	</li>
	<li>
	<p>Greek letters (e.g., ∑)</p>
	</li>
	<li>
	<p>Operators or other special characters (e.g., ∫—see <a data-type="xref" href="#unicode">???</a>)</p>
	</li>
</ul>

<p>For example, write the Pythagorean theorem in text, but not the quadratic formula.</p>

<p>Here are some examples:</p>

<dl>
	<dt>Titled formal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;equation id="pythagorean"&gt;
&lt;title&gt;Pythagorean Theorem&lt;/title&gt;
  &lt;mathphrase&gt;
    &lt;emphasis&gt;a&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt; + 
    &lt;emphasis&gt;b&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt; = 
    &lt;emphasis&gt;c&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt;
  &lt;/mathphrase&gt;
&lt;/equation&gt;</pre>

	<div data-type="equation" id="pythagorean">
	<h5>Pythagorean theorem</h5>

	<p><em>a</em><sup>2</sup> + <em>b</em><sup>2</sup> = <em>c</em><sup>2</sup></p>
	</div>
	</dd>
	<dt>Block, untitled informal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;informalequation&gt;
  &lt;mathphrase&gt;
    &lt;emphasis&gt;a&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt; + 
    &lt;emphasis&gt;b&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt; = 
    &lt;emphasis&gt;c&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt;
  &lt;/mathphrase&gt;
&lt;/informalequation&gt;</pre>

	<div data-type="equation" id="id-Be3Tp">
	<p><em>a</em><sup>2</sup> + <em>b</em><sup>2</sup> = <em>c</em><sup>2</sup></p>
	</div>
	</dd>
	<dt>Inline equation</dt>
	<dd>
	<p>Simply write the math inline with the regular text, styling with emphasis, superscript, and subscript as needed. (An <code>inlineequation</code> element does exist, but it’s not necessary for standard rendering in our toolchain.)</p>

	<pre data-type="programlisting">
&lt;para&gt;Here is a simple text inline equation: &lt;emphasis&gt;a&lt;/emphasis&gt;
&lt;superscript&gt;2&lt;/superscript&gt; + &lt;emphasis&gt;b&lt;/emphasis&gt;&lt;superscript&gt;2
&lt;/superscript&gt; = &lt;emphasis&gt;c&lt;/emphasis&gt;&lt;superscript&gt;2&lt;/superscript&gt; 
(yes, it's the Pythagorean theorem).&lt;/para&gt;</pre>

	<p>Here is a simple text inline equation: <em>a</em><sup>2</sup> + <em>b</em><sup>2</sup> = <em>c</em><sup>2</sup> (yes, it’s the Pythagorean theorem).</p>
	</dd>
</dl>
</section>

<section data-type="sect2" id="complex-math-mDkIY">
<h2>Complex Math</h2>

<p>You have three options for representing more complex math in your book: LaTeX, MathML, or images (we prefer the first two).</p>

<section data-type="sect3" id="latex-WMjF4">
<h3>LaTeX</h3>

<p>All LaTeX equations in DocBook source should be tagged as <code>mathphrase</code> with <code>role="tex"</code> set on the element. LaTeX <code>mathphrase</code> elements should be wrapped in <code>equation</code> for titled block equations, <code>informalequation</code> for untitled block equations, and <code>&lt;inlineequation&gt;</code> for inline equations.</p>

<p>Here are some markup examples:</p>

<dl>
	<dt>Titled formal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;equation&gt;
  &lt;title&gt;Derivative&lt;/title&gt;
  &lt;mathphrase role="tex"&gt;\begin{equation}
  {\frac{dy}{dx} = 2x}
  \end{equation}&lt;/mathphrase&gt;
&lt;/equation&gt;</pre>

	<div data-type="equation" id="derivative-g88F7">
	<h5>Derivative</h5>

	<p data-type="latex">\begin{equation} {\frac{dy}{dx} = 2x} \end{equation}</p>
	</div>
	</dd>
	<dt>Block, untitled informal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;informalequation&gt;
  &lt;mathphrase role="tex"&gt;\begin{equation}
  {\int_{-10}^{10}x^2\,dx}
  \end{equation}&lt;/mathphrase&gt;
&lt;/informalequation&gt;</pre>

	<p data-type="latex">\begin{equation} {\int_{-10}^{10}x^2\,dx} \end{equation}</p>
	</dd>
	<dt>Inline equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;para&gt;The volume of a sphere can be calculated with the formula 
&lt;inlineequation&gt;&lt;mathphrase role="tex"&gt;$\frac{4}{3} \pi r^3$&lt;/mathphrase&gt;
&lt;/inlineequation&gt;.&lt;/para&gt;</pre>

	<p>The volume of a sphere can be calculated with the formula <span data-type="latex">$\frac{4}{3} \pi r^3$</span>.</p>
	</dd>
</dl>

<p>Here are a couple of helpful resources:</p>

<ul>
	<li>
	<p><a href="http://latexsearch.com/sandbox.do">LaTeX Sandbox</a></p>
	</li>
	<li>
	<p><a href="https://chrome.google.com/webstore/detail/daum-equation-editor/dinfmiceliiomokeofbocegmacmagjhe?hl=en">Daum Equation Editor online</a><span data-type="footnote">This is a <a href="https://itunes.apple.com/us/app/daum-equation-editor/id540665783?mt=12">free tool</a> (also usable online via the Chrome browser) that’s good for creating LaTeX equations via a WYSIWYG interface.</span></p>
	</li>
	<li>
	<p><a href="http://www.wiris.net/demo/editor/demo/en/">WIRIS editor</a><span data-type="footnote">Not free, but we can potentially provide you with a license.</span></p>
	</li>
</ul>
</section>

<section data-type="sect3" id="mathml-g4Au0">
<h3>MathML</h3>

<p>If you’d like to use MathML markup, please make sure to include this modified DTD at the top of your XML files:</p>

<pre data-type="programlisting">
&lt;!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" 
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
&lt;!ENTITY % MATHML.prefixed "INCLUDE"&gt;
&lt;!ENTITY % MATHML.prefix "mml"&gt;
&lt;!ENTITY % equation.content "(alt?, (graphic+|mediaobject+|mml:math))"&gt;
&lt;!ENTITY % inlineequation.content "(alt?, (inlinegraphic+|inlinemediaobject+|
mml:math))"&gt;
&lt;!ENTITY % mathml PUBLIC "-//W3C//DTD MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/mathml2.dtd"&gt;
%mathml;
]&gt;</pre>

<p>MathML markup is very complex, and it would be difficult to include a primer in the space here. Here are some helpful resources:</p>

<ul>
	<li>
	<p><a href="http://www.xmlmind.com/tutorials/MathML/index.html#d0e417">MathML Presentation Markup for the Impatient</a></p>
	</li>
	<li>
	<p><a href="http://www.w3.org/TR/MathML2/">W3C MathML 2.0 recommendation</a></p>
	</li>
	<li>
	<p><a href="http://www.sagehill.net/docbookxsl/MathML.html">Bob Stayton’s guide to MathML</a></p>
	</li>
	<li>
	<p><a href="http://www.w3.org/Math/Software/">W3C MathML implementations page</a></p>
	</li>
</ul>

<p>Please write to <a class="email" href="mailto:toolsreq@oreilly.com"><em>toolsreq@oreilly.com</em></a> with any questions.</p>
</section>

<section data-type="sect3" id="images-GqbC1">
<h3>Images</h3>

<p>If you don’t want to use LaTeX or MathML, you can create expressions using an equation editor and save them as images. Here are a few, but feel free to try others:</p>

<dl>
	<dt><a href="http://www.dessci.com/en/products/mathtype/trial.asp">MathType</a></dt>
	<dd>
	<p>Use this application to create equations and save them as images. Comes with a free trial.</p>
	</dd>
	<dt>Word’s built-in EquationEditor</dt>
	<dd>
	<p>If you have Word 2007, do not create equations with the default EE; use the previous EE, which you can access from the Insert ribbon. When you have created an equation, you can capture it as a screenshot.</p>
	</dd>
</dl>

<p>Here are some markup examples:</p>

<dl>
	<dt>Titled formal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;equation id="quadratic"&gt;
&lt;title&gt;Quadratic Formula&lt;/title&gt;
  &lt;mediaobject&gt;
    &lt;imageobject&gt;
      &lt;imagedata fileref="images/quadratic.png" format="PNG" /&gt;
    &lt;/imageobject&gt;
  &lt;/mediaobject&gt;
&lt;/equation&gt;</pre>
	</dd>
	<dt>Block, untitled informal equation</dt>
	<dd>
	<pre data-type="programlisting">
&lt;informalequation&gt;
  &lt;mediaobject&gt;
    &lt;imageobject&gt;
      &lt;imagedata fileref="images/quadratic.png" format="PNG" /&gt;
    &lt;/imageobject&gt;
  &lt;/mediaobject&gt;
&lt;/informalequation&gt;</pre>
	</dd>
	<dt>Inline equation</dt>
	<dd>
	<p><em>None.</em> Avoid using images for inline equations. Sizing inline images poses difficulties in downstream formats, as some ereaders may render the images much larger or smaller than the surrounding text (which can lead to customer complaints). If you need to use an image, set it apart from the text as an <code>informalequation</code> as described above.</p>
	</dd>
</dl>
</section>
</section>
</section>
</section>


    
  </body>
</html>